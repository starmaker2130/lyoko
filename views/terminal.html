<!DOCTYPE html>
<html>
<head>
    <title>LYOKO Terminal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        
        body, html{
            width: 100%;
            height: 100%;
            font-family: monospace;
        }
        
        div {
            display: inline-block;
        }
        
        #terminal-input-container{
            position: absolute;
            top: 5%;
            left: 5%;
            border-radius: 10px;
        }
        
        #submit-terminal-input-button{
            background-color: black;
            color: white;
            font-weight: 200;
            text-transform: uppercase;
            position: absolute;
            border-radius: 5px;
            width: 375px;
            height: 50px;
            line-height: 50px;
            text-align: center;
            bottom: 10%;
            left: 5%;
        }
    </style>
    <script>
        function Lyoko(){
            return {
                lexer: function(data){
                    console.log(` ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n fx] lexer | core lyoko function \n~~~~~~~~~~~~~~\n raw: ${data}`);
                    
                    let rawLexicalInput = data;
                    let rawInputArray = [];
                    let mark = 0;
                    while(rawLexicalInput.indexOf(" ")>-1){
                        mark = rawLexicalInput.indexOf(" ");
                        
                        if(mark==0)mark==1;
                        
                        rawInputArray.push(rawLexicalInput.substring(0, mark));
                        rawLexicalInput = rawLexicalInput.substring(mark+1);
                    }
                    rawInputArray.push(rawLexicalInput);                 
                    //console.log(rawInputArray);                    
                    console.log("lexer called complete");
                    return rawInputArray;
                },
                parser: function(data){
                    console.log(` ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n fx] parser | core lyoko function \n~~~~~~~~~~~~~~\n number of terms: ${data.length}`);
                    
                    let term, i;
                    let self = this;
                    for(i=0; i<data.length; i++){
                        term = data[i].toUpperCase();
                        //console.log(term);
                        
                        term = this.comb({term: term, index: i});
                        //console.log(term);
                        if(self.dictionary[term]!=undefined){
                            self.dictionary[term]({code: 0, index: i});
                        }
                        else{
                            if(term.indexOf("ED")>-1){
                                let morph = term.substring(0, term.indexOf("ED"));
                                if(self.dictionary[morph]!=undefined){
                                    self.dictionary[morph]({code: 0, index: i});
                                }
                            }
                            else{
                                self.dictionary.stack.STREAM.push({
                                    type: "semantic-node",
                                    name: term,
                                    index: i
                                });
                            }    
                        }
                    }
                   
                    return self.dictionary.stack.STREAM;
                    /*
                    console.log('final action stream:');
                    console.log(self.dictionary.stack.STREAM)
                    if(self.dictionary.stack.PHRASE!=null){
                        console.log('------------------------ \n    PHRASES \n -----------------------');
                        console.log(self.dictionary.stack.PHRASE);
                    }
                    if(self.dictionary.stack.SENTENCE!=null){
                        console.log('------------------------ \n  SENTENCES \n -----------------------');
                    
                        console.log(self.dictionary.stack.SENTENCE);
                    }
                    */
                },
                comb: function(data){
                    let self = this;
                    let raw = data.term;
                    let punctuation = [
                        ".",    //0
                        ",",    //1
                        "!",    //2
                        "?",    //3
                        ";",    //4
                        ":",    //5
                        "%",    //6
                        "(",    //7
                        ")",    //8
                        '"',    //9
                    ];
                    
                    let count = [];
                    let final = "";
                    for(let j=0; j< punctuation.length; j++){
                        if(raw.indexOf(punctuation[j])>-1){
                            count.push(punctuation[j]);
                            raw = raw.substring(0, raw.indexOf(punctuation[j]))+raw.substring(raw.indexOf(punctuation[j])+1);
                        }
                    }
                    if(count.includes(punctuation[0])){
                        if(self.dictionary.stack.ENVIRONMENT!=null){
                            let env = self.dictionary.stack.ENVIRONMENT[0].env;
                        }
                        self.dictionary.stack.SENTENCE.push({
                            type: "environment",
                            name: "pARk",
                            index: data.index
                        });
                    }                    
                    if(count.includes(punctuation[9])){
                        if(self.dictionary.stack.OBJECTSUBJECTS==null){
                            self.dictionary.stack.OBJECTSUBJECTS = []
                        }
                        self.dictionary.stack.OBJECTSUBJECTS.push({
                            obj: data.term,
                            index: data.index
                        });
                    }
                    
                    return raw;
                    
                },
                dictionary: {
                    addToStream: function(){
                        
                    },
                    stack: {
                        ENVIRONMENT: null,
                        SUBJECTOBJECTS: null,
                        OBJECTSUBJECTS: null,
                        EFFECTORS: null,
                        SELECTORS: null,
                        STREAM: [],
                        PHRASE: [],
                        SENTENCE: [],
                        SEMANTICS: [],
                        core:{
                            ENGLISH: {
                                hov: {
                                    "hyperreality-in" : {
                                        type: "effector-infinite",
                                        traditionalType: "verb",
                                        definition: [
                                            {
                                                type: "verb",
                                                order: 1,
                                                text: "IN."
                                            },
                                        ]
                                    },
                                    "hyperreality-is" : {
                                        type: "effector-infinite",
                                        traditionalType: "verb",
                                        definition: [
                                            {
                                                type: "verb",
                                                order: 1,
                                                text: "IS."
                                            },
                                        ]
                                    },
                                    "hyperreality-you" : {
                                        type: "subject-object",
                                        traditionalType: "noun",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "YOU."
                                            },
                                        ]
                                    },
                                    "hyperreality-film" : {
                                        type: "effector-finite",
                                        traditionalType: "verb",
                                        definition: [
                                            {
                                                type: "verb",
                                                order: 1,
                                                text: "FILM."
                                            },
                                        ]
                                    },
                                    "SNACK" : {
                                        type: "object-subject",
                                        traditionalType: "multiple",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "a small portion of food or drink or a light meal, especially one eaten between regular meals."
                                            },
                                            {
                                                type: "noun",
                                                order: 2,
                                                text: "a share or portion"
                                            },
                                            {
                                                type: "noun",
                                                order: 3,
                                                text: "something easily done.",
                                                usage: "note: Australian Slang"
                                            },
                                            {
                                                type: "verb",
                                                order: 4,
                                                text: "to have a snack or light meal, especially between regular meals:"
                                            }
                                        ]
                                    },
                                    "SNACKS": function(){
                                        return this.SNACK;
                                    },
                                    "SHACK" : {
                                        type: "object-subject",
                                        traditionalType: "multiple",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "a rough cabin; shanty."
                                            },
                                            {
                                                type: "noun",
                                                order: 2,
                                                text: "radio shack",
                                                usage: "Informal"
                                            },
                                            {
                                                type: "verb",
                                                order: 3,
                                                text: "shack up",
                                                usage: "a: to live together as spouses without being legally married; b: to have illicit sexual relations; c: to live in a shack;"
                                            },
                                        ]
                                    },
                                    "STREAM" : {
                                        type: "object-subject",
                                        traditionalType: "multiple",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 0,
                                                text: "hypermedia flowing as a series of packets or a buffer of data"
                                            },
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "a body of water flowing in a channel or watercourse, as a river, rivulet, or brook."
                                            },
                                            {
                                                type: "noun",
                                                order: 2,
                                                text: "a steady current in water, as in a river or the ocean:"
                                            },
                                            {
                                                type: "verb",
                                                order: 9,
                                                text: "to flow, pass, or issue in a stream, as water, tears, or blood.",
                                                usage: "note: used without object"
                                            },
                                            {
                                                type: "verb",
                                                order: 10,
                                                text: "to send forth or throw off a stream; run or flow (often followed by with):",
                                                usage: "note: used without object"
                                            },
                                            {
                                                type: "noun",
                                                order: 15,
                                                text: "to send forth or discharge in a stream:",
                                                usage: "note: used with object"
                                            },
                                            {
                                                type: "noun",
                                                order: 16,
                                                text: "to cause to stream or float outward, as a flag.",
                                                usage: "note: used with object"
                                            }
                                        ]
                                    },
                                    "STORE" : {
                                        type: "object-subject",
                                        traditionalType: "multiple",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "an establishment where merchandise is sold, usually on a retail basis."
                                            },
                                            {
                                                type: "noun",
                                                order: 2,
                                                text: "a grocery"
                                            },
                                            {
                                                type: "verb",
                                                order: 8,
                                                text: "to supply or stock with something, as for future use.",
                                                usage: "note: used with object"
                                            },
                                            {
                                                type: "verb",
                                                order: 9,
                                                text: "to accumulate or put away, for future use (usually followed by up or away).",
                                                usage: "note: used with object"
                                            },
                                            {
                                                type: "noun",
                                                order: 12,
                                                text: "to take in or hold supplies, goods, or articles, as for future use.",
                                                usage: "note: used without object"
                                            },
                                            {
                                                type: "noun",
                                                order: 13,
                                                text: "to remain fresh and usable for considerable time on being stored:",
                                                usage: "note: used without object"
                                            }
                                        ]
                                    },
                                    "ORDER" : {
                                        type: "object-subject",
                                        traditionalType: "multiple",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "an authoritative direction or instruction; command; mandate."
                                            },
                                            {
                                                type: "noun",
                                                order: 2,
                                                text: "a command of a court or judge."
                                            },
                                            {
                                                type: "noun",
                                                order: 3,
                                                text: "a command or notice issued by a military organization or a military commander to troops, sailors, etc"
                                            },
                                            {
                                                type: "verb",
                                                order: 37,
                                                text: "to give an order, direction, or command to:",
                                                usage: "note: used with object"
                                            },
                                            {
                                                type: "noun",
                                                order: 38,
                                                text: "to direct or command to go or come as specified:",
                                                usage: "note: used with object"
                                            },
                                            {
                                                type: "noun",
                                                order: 46,
                                                text: "to give an order or issue orders:",
                                                usage: "note: used without object"
                                            }
                                        ]
                                    },
                                    "ORDERS": function(){
                                        return this.ORDER;
                                    },
                                    "FRIEND" : {
                                        type: "object-subject",
                                        traditionalType: "multiple",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "a person attached to another by feelings of affection or personal regard."
                                            },
                                            {
                                                type: "noun",
                                                order: 2,
                                                text: "a person who gives assistance; patron; supporter:"
                                            },
                                            {
                                                type: "noun",
                                                order: 3,
                                                text: "a person who is on good terms with another; a person who is not hostile:"
                                            },
                                            {
                                                type: "noun",
                                                order: 4,
                                                text: "a member of the same nation, party, etc."
                                            },
                                            {
                                                type: "noun",
                                                order: 7,
                                                text: "to befriend.",
                                                usage: "note: used with object"
                                            },
                                            {
                                                type: "noun",
                                                order: 8,
                                                text: "to add (a person) to one's list of contacts on a social media website:",
                                                usage: "note: used with object"
                                            }
                                        ]
                                    },
                                    "FRIENDS": function(){
                                        return this.FRIEND;
                                    },
                                    "CONTENT" : {
                                        type: "object-subject",
                                        traditionalType: "multiple",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "Usually contents",
                                                usage: "a: something that is contained; b: the subjects or topics covered in a book or document; c: the chapters or other formal divisions of a book or document;"
                                            },
                                            {
                                                type: "noun",
                                                order: 2,
                                                text: "something that is to be expressed through some medium, as speech, writing, or any of various arts:"
                                            },
                                            {
                                                type: "noun",
                                                order: 3,
                                                text: "significance or profundity; meaning:"
                                            },
                                            {
                                                type: "noun",
                                                order: 4,
                                                text: "substantive information or creative material viewed in contrast to its actual or potential manner of presentation:"
                                            },
                                            {
                                                type: "noun",
                                                order: 5,
                                                text: "to take in or hold supplies, goods, or articles, as for future use.",
                                                usage: "note: used without object"
                                            },
                                            {
                                                type: "noun",
                                                order: 5,
                                                text: "that which may be perceived in something:"
                                            },
                                            {
                                                type: "noun",
                                                order: 6,
                                                text: "Philosophy, Logic. the sum of the attributes or notions comprised in a given conception; the substance or matter of cognition."
                                            }
                                        ]
                                    },
                                    "STRAIGHT" : {
                                        type: "effector-descriptor",
                                        traditionalType: "multiple",
                                        definition: [
                                            {
                                                type: "adjective",
                                                order: 1,
                                                text: "without a bend, angle, or curve; not curved; direct:"
                                            },
                                            {
                                                type: "adjective",
                                                order: 2,
                                                text: "exactly vertical or horizontal; in a perfectly vertical or horizontal plane:"
                                            },
                                            {
                                                type: "adverb",
                                                order: 20,
                                                text: "in a straight line:"
                                            },
                                            {
                                                type: "adverb",
                                                order: 21,
                                                text: "in an even form or position:"
                                            },
                                            {
                                                type: "noun",
                                                order: 34,
                                                text: "the condition of being straight."
                                            },
                                            {
                                                type: "noun",
                                                order: 35,
                                                text: "a straight form or position"
                                            }
                                        ]
                                    },
                                    "CLOUD" : {
                                        type: "subject-object",
                                        traditionalType: "noun",
                                        definition: [
                                            {
                                                type: "noun",
                                                order: 1,
                                                text: "ARIA + WINDOW MAILBOX."
                                            },
                                        ]
                                    },
                                }
                            }
                        }
                    },  //0 = store value in parser stream
                    // 1 = activate default execution
                    PARK: function(data){
                        let self = this;
                        //console.log(`[LPARSER] PARK`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 100px; height: 100px; background-color: blue; color: white; border-radius: 50%; text-align: center; line-height: 100px;";
                        marker.innerHTML = "pARk";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "environment",
                                name: "pARk",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute pARk functionality');
                        }
                        
                        //document.getElementById("atown-output-container").appendChild(marker);
                    },
                    PLAYLIST: function(data){
                        let self = this;
                        //console.log(`[LPARSER] PLAYLIST`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 75px; height: 75px; background-color: yellow; color: black; border-radius: 50%; text-align: center; line-height: 75px;";
                        marker.innerHTML = "playlist";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "objsubj",
                                name: "playlist",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute playlist functionality');
                        }       
                    },
                    FIND: function(data){
                        let self = this;
                        //console.log(`[LPARSER] FIND`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 100px; height: 75px; background-color: green; color: white; border-radius: 15px; text-align: center; line-height: 75px;";
                        marker.innerHTML = "search";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "selector-finite",
                                name: "subtract",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute search (core subtraction) functionality');
                        }       
                    },
                    LOCALIZE: function(data){
                        let self = this;
                        //console.log(`[LPARSER] LOCALIZE`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 75px; height: 75px; background-color: yellow; color: black; border-radius: 50%; text-align: center; line-height: 100px;";
                        marker.innerHTML = "playlist";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "objsubj",
                                name: "playlist",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute playlist functionality');
                        }       
                    },
                    REALIZE: function(data){
                        let self = this;
                        //console.log(`[LPARSER] REALIZE`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: violet; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "xr";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-finite",
                                name: "hyperreality",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute realize (core hyperreality) functionality');
                        }       
                    },
                    DELIVER: function(data){
                        let self = this;
                        //console.log(`[LPARSER] DELIVER`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: red; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "deliver";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-finite",
                                name: "delivery",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute delivery (core delivery) functionality');
                        }       
                    },
                    STREAM: function(data){
                        let self = this;
                        //console.log(`[LPARSER] STREAM`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: red; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "deliver";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-finite",
                                name: "delivery",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute delivery (core delivery) functionality');
                        }     
                    },
                    FILM: function(data){
                        let self = this;
                        //console.log(`[LPARSER] FILM`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: red; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "deliver";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-finite",
                                name: "hyperreality-film",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){// TODO point this functionality to the core dictionary definitions TODO
                            console.log(' execute film functionality');
                        }     
                    },
                    CLOUD: function(data){
                        let self = this;
                        //console.log(`[LPARSER] FILM`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: lightgray; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "CLOUD";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "subject-object",
                                name: "cloud",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute cloud functionality');
                        }     
                    },
                    BRING: function(data){
                        let self = this;
                        //console.log(`[LPARSER] BRING`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: red; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "deliver";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-finite",
                                name: "delivery-bring",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute bring (core delivery) functionality');
                        }     
                    },
                    COLLABORATE: function(data){
                        let self = this;
                        //console.log(`[LPARSER] COLLABORATE`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: red; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "deliver";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-finite",
                                name: "collaborate",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute delivery (core delivery) functionality');
                        }     
                    },
                    IN: function(data){
                        let self = this;
                        //console.log(`[LPARSER] IN`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: orange; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "in";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-infinite",
                                name: "hyperreality-in",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute in (core existential attachment) functionality');
                        }     
                    },
                    IS: function(data){
                        let self = this;
                        //console.log(`[LPARSER] IS`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: red; color: white; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "is";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-infinite",
                                name: "hyperreality-is",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute is (core existential attachment) functionality');
                        }     
                    },
                    YOU: function(data){
                        let self = this;
                        //console.log(`[LPARSER] YOU`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 50px; height: 50px; background-color: yellow; color: black; border-radius: 50%; text-align: center; line-height: 50px;";
                        marker.innerHTML = "YOU";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "subject-object",
                                name: "hyperreality-you",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute you (core identity) functionality');
                        }     
                    },
                    0: function(data){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "zero";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "zero",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute zero functionality');
                        }     
                    },
                    1: function(data){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "one";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "one",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute one functionality');
                        }
                    },
                    2: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "two";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "two",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute two functionality');
                        }
                    },
                    3: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "three";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "three",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute three functionality');
                        }
                    },
                    4: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "four";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "four",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute four functionality');
                        }
                    },
                    5: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "five";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "five",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute five functionality');
                        }
                    },
                    6: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "six";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "six",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute six functionality');
                        }
                    },
                    7: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "seven";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "seven",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute seven functionality');
                        }
                    },
                    8: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "eight";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "eight",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute eight functionality');
                        }
                    },
                    9: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "nine";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "nine",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute nine functionality');
                        }
                    },
                    10: function(){
                        let self = this;
                        //console.log(`[LPARSER] O [INT]`);
                        
                        let marker = document.createElement("div")
                        marker.style = "width: 10px; height: 10px; background-color: black; color: white; border-radius: 50%; text-align: center; line-height: 10px;";
                        marker.innerHTML = "ten";
                        
                        if(data.code==0){
                            self.stack.STREAM.push({
                                type: "effector-descriptor",
                                name: "ten",
                                element: marker,
                                index: data.index
                            });
                        }
                        else if(data.code==1){
                            console.log(' execute ten functionality');
                        }
                    },
                    ZERO: function(data){
                        let self = this;
                        self[0]({code: data.code, index: data.index});
                    },
                    ONE: function(){
                        let self = this;
                        self[1]({code: data.code, index: data.index});
                    },
                    TWO: function(){
                        let self = this;
                        self[2]({code: data.code, index: data.index});
                    },
                    THREE: function(){
                        let self = this;
                        self[3]({code: data.code, index: data.index});
                    },
                    FOUR: function(){
                        let self = this;
                        self[4]({code: data.code, index: data.index});
                    },
                    FIVE: function(){
                        let self = this;
                        self[5]({code: data.code, index: data.index});
                    },
                    SIX: function(){
                        let self = this;
                        self[6]({code: data.code, index: data.index});
                    },
                    SEVEN: function(){
                        let self = this;
                        self[7]({code: data.code, index: data.index});
                    },
                    EIGHT: function(){
                        let self = this;
                        self[8]({code: data.code, index: data.index});
                    },
                    NINE: function(){
                        let self = this;
                        self[9]({code: data.code, index: data.index});
                    },
                    TEN: function(){
                        let self = this;
                        self[10]({code: data.code, index: data.index});
                    }
                },
                execute: function(stream){
                    let self = this;
                    let parseStream = stream || self.dictionary.stack.STREAM;
                    let sections = [];
                    let breakpoints = [];
                    
                    for(let j=0; j<self.dictionary.stack.SENTENCE.length; j++){// store the locations of the sentence endings (periods/full stops)
                        breakpoints.push(self.dictionary.stack.SENTENCE[j].index);
                    }
                    
                    for(let h=0; h<breakpoints.length; h++){
                        let l;
                        if(h==0){
                            l = 0;
                        }
                        else{
                            l = breakpoints[h-1];
                        }
                        
                        while(l<breakpoints[h]){
                            /*if(parseStream[l].element!=null){
                                document.getElementById("atown-output-container").appendChild(parseStream[l].element);
                            }*/
                            if(self.dictionary.stack.PHRASE.length==h){
                                self.dictionary.stack.PHRASE.push([]);
                            }
                            self.dictionary.stack.PHRASE[h].push(parseStream[l]);
                            l++;
                        }
                    }
                    
                    console.log("----phrases----");
                    let phrases = self.dictionary.stack.PHRASE;
                    console.log(phrases);
                    for(let m = 0; m<phrases.length; m++){
                        
                        if(self.dictionary.stack.SEMANTICS.length==m){
                            self.dictionary.stack.SEMANTICS.push(
                                {
                                    score: 0,
                                    env: 0,     // 0    basis of reality
                                    objsubj: 0, //  1   item in story, often acted on, passive
                                    semnode: 0,  //  2   item in story --> semantic analysis
                                    selector: 0,  //3   aids the viewer in taking action, focus
                                    effector: 0, // 4   what allows the viewer to affect action
                                    subjobj: 0, //  5   viewer, drives perspective of story    
                                });
                        }
                        
                        for(let n = 0; n<phrases[m].length; n++){
                            let lexType = phrases[m][n].type;
                            //console.log(self.dictionary.stack.SEMANTICS[m]);
                            
                            /* relabel the types that need relabeling */
                            if(lexType=="semantic-node"){
                                let query = phrases[m][n].name;
                                //let dict = "";
                                if(self.dictionary.stack.core.ENGLISH.hov[query]!=null){
                                    lexType = self.dictionary.stack.core.ENGLISH.hov[query].type;
                                }
                                /*else{
                                    dict = "semantic-node";
                                }
                                //console.log(dict.type);
                                lexType = "semantic-node";*/
                            }
                            
                            
                            /* add phrase elements to output */
                            if(n==0){   //add phrase container at the start of a new sentence
                                var phraseContainer = document.createElement("div");
                                phraseContainer.style = "display: inline-block; width: 275px; height: 150px; border-radius: 15px; padding: 2%; margin: 1% auto; cursor: pointer; background-color: aquamarine; color: white;";
                                phraseContainer.setAttribute("id", `phrase-container-${m}`);
                                document.getElementById("atown-output-container").appendChild(phraseContainer);
                            }
                            
                            if(phrases[m][n].element!=null){    // if there is an element associated witht his term add it to the ATOWN output
                                document.getElementById(`phrase-container-${m}`).appendChild(phrases[m][n].element);
                            }
                            else if(phrases[m][n].element==null){
                                if(lexType==undefined||lexType==null||lexType=="undefined"){       
                                    let ref = self.dictionary.stack.core.ENGLISH.hov[phrases[m][n].name]();
                                    console.log(`] unknown lex type: ${lexType}`);
                                    lexType = ref.type;
                                    console.log(lexType);
                                }
                                if(lexType == "object-subject"){
                                    let object = document.createElement("div");
                                    let objName = phrases[m][n].name;
                                    object.style= "width: 50px; height: 50px; border-radius: 50%; text-align: center; line-height: 50px; background-color: white; color: black;"
                                    object.classList.add("object-subject-node");
                                    object.setAttribute("id", `term-${m}-${n}-${objName}`);
                                    
                                    
                                    document.getElementById(`phrase-container-${m}`).appendChild(object);
                                    document.getElementById(`term-${m}-${n}-${objName}`).append(objName);
                                }
                                
                            }
                            
                            
                            
                            /* process the semantic properties of the labels */
                            switch(lexType){
                                case "environment":
                                    self.dictionary.stack.SEMANTICS[m].env++;
                                    break;
                                case "semantic-node":
                                    self.dictionary.stack.SEMANTICS[m].semnode+=2;
                                    self.dictionary.stack.SEMANTICS[m].score+=2;
                                    break;
                                case "effector-infinite":
                                    self.dictionary.stack.SEMANTICS[m].effector+=4.5;
                                    self.dictionary.stack.SEMANTICS[m].score+=4.5;
                                    break;
                                case "effector-descriptor":
                                case "effector-finite":
                                    self.dictionary.stack.SEMANTICS[m].effector+=4;
                                    self.dictionary.stack.SEMANTICS[m].score+=4;
                                    break;
                                case "selector-infinite":
                                    self.dictionary.stack.SEMANTICS[m].selector+=3.5;
                                    self.dictionary.stack.SEMANTICS[m].score+=3.5;
                                    break;
                                case "selector-finite":
                                    self.dictionary.stack.SEMANTICS[m].selector+=3;
                                    self.dictionary.stack.SEMANTICS[m].score+=3;
                                    break;
                                case "subject-object":
                                    self.dictionary.stack.SEMANTICS[m].subjobj+=5;
                                    self.dictionary.stack.SEMANTICS[m].score+=5;
                                    break;
                                case "object-subject":
                                    self.dictionary.stack.SEMANTICS[m].objsubj+=1;
                                    self.dictionary.stack.SEMANTICS[m].score+=1;
                                    break;
                                default:
                                    console.log(`unknown lex type: ${lexType}`);
                                    console.log("undefined lex parser value reached");
                                    console.log(phrases[m][n]);
                                    break;
                            }
                        }
                        
                        
                    }
                    
                    console.log("------semantics-------");
                    console.log(self.dictionary.stack.SEMANTICS);
                    
                }
            }
        }
        document.addEventListener("DOMContentLoaded", function(){
            document.getElementById("submit-terminal-input-button").addEventListener("click", function(){
                let speech = document.getElementById("terminal-input-container").value;
                
                var session = Lyoko();
                let parseList = session.lexer(speech);
                let parseStream = session.parser(parseList);
                session.execute(parseStream);
            });
        });
    </script>
</head>
<body>
    <textarea rows="30" cols="50"id="terminal-input-container"></textarea>
    <input type="button" id="submit-terminal-input-button" value="submit" />
    <div id="atown-output-container" style="width: 300px; height: 500px; border: 2px black solid; border-radius: 10px; position: absolute; right: 5%; top: 5%; display: block;"></div>
</body>
</html>
<!-- In the pARk, there is a store called "Snack Shack". In this store, you can stream whatever content you like and watch it with friends. You can also order snacks delivered straight to your Cloud.-->